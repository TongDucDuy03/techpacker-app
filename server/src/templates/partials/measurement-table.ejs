<div class="section-title"><%= strings.measurementTitle %></div>

<% const sizeHeaders = measurements.columns.sizes || []; %>
<% const groupColspan = 5 + sizeHeaders.length; %>

<% if (measurements.rows && measurements.rows.length) { %>
  <table class="measurement-table">
    <thead>
      <tr>
        <th style="width:10%;">POM</th>
        <th style="width:26%;">Description</th>
        <th style="width:6%;" class="text-center">- Tol</th>
        <th style="width:6%;" class="text-center">+ Tol</th>
        <% sizeHeaders.forEach((size) => { %>
          <th class="size-col"><%= size %></th>
        <% }) %>
        <th style="width:18%;">Notes</th>
      </tr>
    </thead>
    <tbody>
      <% measurements.rows.forEach((row) => { %>
        <% if (row.isGroup) { %>
          <tr class="group-row">
            <td colspan="<%= groupColspan %>"><%= row.label %></td>
          </tr>
        <% } else { %>
          <tr class="<%= row.critical ? 'avoid-break' : '' %>">
            <td>
              <div><strong><%= row.pomCode %></strong></div>
              <% if (row.type) { %>
                <div class="text-muted">Type: <%= row.type %></div>
              <% } %>
              <% if (row.category) { %>
                <div class="text-muted">Category: <%= row.category %></div>
              <% } %>
              <% if (row.critical) { %>
                <div style="margin-top:4px;">
                  <span style="background:#fee2e2; color:#b91c1c; padding:2px 6px; border-radius:4px; font-size:8px; font-weight:700;">
                    CRITICAL
                  </span>
                </div>
              <% } %>
            </td>
            <td><%= row.pomName %></td>
            <td class="tol-minus"><%= row.toleranceMinus %></td>
            <td class="tol-plus"><%= row.tolerancePlus %></td>
            <% sizeHeaders.forEach((size) => { %>
              <td class="size-col"><%= row.sizes[size] !== undefined ? row.sizes[size] : '—' %></td>
            <% }) %>
            <td>
              <div><%= row.notes || '—' %></div>
              <% if (row.updatedAt) { %>
                <div class="text-muted">Updated: <%= row.updatedAt %></div>
              <% } %>
            </td>
          </tr>
        <% } %>
      <% }) %>
    </tbody>
  </table>

  <div class="summary-grid">
    <div class="summary-card">
      <h4><%= strings.measurementSummary %></h4>
      <p>Total POM: <strong><%= measurements.stats.total %></strong></p>
      <p>Critical: <strong><%= measurements.stats.critical %></strong></p>
      <p>Groups: <strong><%= measurements.stats.groups %></strong></p>
    </div>
    <div class="summary-card">
      <h4><%= strings.measurementSizes %></h4>
      <p>Range: <strong><%= measurements.stats.sizeRange %></strong></p>
      <p>Size columns: <strong><%= sizeHeaders.length %></strong></p>
      <p>Complete rows: <strong><%= measurements.stats.completeRows %></strong></p>
    </div>
  </div>
<% } else { %>
  <div style="padding:32px; text-align:center; color:#94a3b8;"><%= strings.emptyMeasurements %></div>
<% } %>
