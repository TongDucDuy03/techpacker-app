<div class="section-title"><%= strings.bomTitle %></div>

<% if (bom && bom.rows && bom.rows.length) { %>
  <table class="bom-table">
    <thead>
      <tr>
        <th style="width:6%;">#</th>
        <th style="width:18%;">Item</th>
        <th style="width:16%;">Details</th>
        <th style="width:12%;">Placement</th>
        <th style="width:8%;" class="text-center">Qty</th>
        <th style="width:8%;" class="text-center">UOM</th>
        <th style="width:14%;">Supplier</th>
        <th style="width:18%;">Notes</th>
      </tr>
    </thead>
    <tbody>
      <% bom.rows.forEach((row, idx) => { %>
        <tr class="<%= row.thumbnail ? 'avoid-break' : '' %>">
          <td class="text-center"><%= row.lineNumber || idx + 1 %></td>
          <td>
            <% if (row.thumbnail) { %>
              <img src="<%= row.thumbnail %>" alt="<%= row.materialName %>" class="thumb" />
            <% } %>
            <div style="margin-top:6px;">
              <strong><%= row.materialName %></strong>
              <% if (row.materialCode) { %>
                <div class="text-muted">Code: <%= row.materialCode %></div>
              <% } %>
              <% if (row.color) { %>
                <div class="text-muted">Color: <%= row.color %></div>
              <% } %>
              <% if (row.pantone) { %>
                <div class="text-muted">Pantone: <%= row.pantone %></div>
              <% } %>
            </div>
          </td>
          <td>
            <div><strong>Part:</strong> <%= row.part || '—' %></div>
            <% if (row.category) { %>
              <div><strong>Category:</strong> <%= row.category %></div>
            <% } %>
            <% if (row.size) { %>
              <div><strong>Size:</strong> <%= row.size %></div>
            <% } %>
            <% if (row.unitPrice) { %>
              <div><strong>Unit Price:</strong> <%= row.unitPrice %></div>
            <% } %>
          </td>
          <td><%= row.placement || '—' %></td>
          <td class="text-center"><%= row.quantity || '—' %></td>
          <td class="text-center"><%= row.uom || '—' %></td>
          <td>
            <div><%= row.supplier || '—' %></div>
            <% if (row.leadTime) { %>
              <div class="text-muted">Lead: <%= row.leadTime %> days</div>
            <% } %>
            <% if (row.moq) { %>
              <div class="text-muted">MOQ: <%= row.moq %></div>
            <% } %>
            <% if (row.statusBadge) { %>
              <div style="margin-top:4px;">
                <span style="background:<%= row.statusBadge.background %>; color:<%= row.statusBadge.color %>; padding:2px 6px; border-radius:4px; font-size:8px; font-weight:600;">
                  <%= row.statusBadge.label %>
                </span>
              </div>
            <% } %>
          </td>
          <td>
            <div><%= row.comments || '—' %></div>
            <% if (row.totalPrice) { %>
              <div class="text-muted">Total: <%= row.totalPrice %></div>
            <% } %>
            <% if (row.updatedAt) { %>
              <div class="text-muted">Updated: <%= row.updatedAt %></div>
            <% } %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <div class="summary-grid">
    <div class="summary-card">
      <h4><%= strings.summaryMaterials %></h4>
      <p>Total materials: <strong><%= bom.rows.length %></strong></p>
      <p>Categories: <strong><%= bom.stats.categories %></strong></p>
      <p>With images: <strong><%= bom.stats.withImages %></strong></p>
    </div>
    <div class="summary-card">
      <h4><%= strings.summarySuppliers %></h4>
      <p>Unique suppliers: <strong><%= bom.stats.uniqueSuppliers %></strong></p>
      <p>Lead time avg: <strong><%= bom.stats.avgLeadTime %></strong></p>
      <p>MOQ avg: <strong><%= bom.stats.avgMoq %></strong></p>
    </div>
  </div>
<% } else { %>
  <div style="padding:32px; text-align:center; color:#94a3b8;"><%= strings.emptyBom %></div>
<% } %>
